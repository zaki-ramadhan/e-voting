<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="src/output.css" rel="stylesheet">
    <title>Voting Ketua OSIS 2025</title>
    <script src="https://code.iconify.design/iconify-icon/3.0.0/iconify-icon.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet" />
</head>

<body class="font-['Space_Grotesk'] bg-yellow-300 min-h-screen">
    <!-- Header -->
    <header class="bg-white border-b-4 border-black p-4">
        <div class="container mx-auto flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div
                    class="w-10 h-10 bg-black text-yellow-300 border-2 border-black flex items-center justify-center font-black text-lg">
                    E
                </div>
                <span class="font-black text-xl text-black">EVOTINGKITA</span>
            </div>
            <div class="hidden sm:flex items-center gap-4">
                <span class="text-sm font-bold text-black bg-green-200 px-3 py-1 border-2 border-black">
                    <iconify-icon icon="mdi:account" width="14" height="14" class="inline mr-1"></iconify-icon>
                    NISN: 1234567890
                </span>
                <button
                    class="text-sm font-bold text-white bg-red-500 px-3 py-1 border-2 border-black hover:bg-red-600 transition-colors">
                    LOGOUT
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Vote Status & Timer -->
        <div class="max-w-4xl mx-auto mb-8">
            <div class="bg-white border-4 border-black shadow-[8px_8px_0px_0px_#000] p-6">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                    <div>
                        <h1 class="text-2xl md:text-3xl font-black text-black mb-2">
                            PEMILIHAN KETUA OSIS 2025
                        </h1>
                        <p
                            class="text-base font-medium text-gray-700 bg-blue-100 border-2 border-black p-2 inline-block">
                            Pilih kandidat terbaik menurut Anda! üó≥Ô∏è
                        </p>
                    </div>
                    <div class="text-right">
                        <div class="bg-red-100 border-2 border-black p-3">
                            <p class="text-sm font-bold text-black">WAKTU TERSISA</p>
                            <p class="text-2xl font-black text-red-600" id="countdown">02:45:30</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Voting Stats -->
        <div class="max-w-4xl mx-auto mb-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-white border-3 border-black shadow-[4px_4px_0px_0px_#000] p-4">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-blue-500 border-2 border-black flex items-center justify-center">
                            <iconify-icon icon="mdi:vote" width="20" height="20" class="text-white"></iconify-icon>
                        </div>
                        <div>
                            <p class="text-xs font-bold text-gray-600">TOTAL VOTE</p>
                            <p class="text-lg font-black text-black">1,247</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white border-3 border-black shadow-[4px_4px_0px_0px_#000] p-4">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-green-500 border-2 border-black flex items-center justify-center">
                            <iconify-icon icon="mdi:account-group" width="20" height="20"
                                class="text-white"></iconify-icon>
                        </div>
                        <div>
                            <p class="text-xs font-bold text-gray-600">PARTISIPASI</p>
                            <p class="text-lg font-black text-black">78.9%</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white border-3 border-black shadow-[4px_4px_0px_0px_#000] p-4">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-purple-500 border-2 border-black flex items-center justify-center">
                            <iconify-icon icon="mdi:account-star" width="20" height="20"
                                class="text-white"></iconify-icon>
                        </div>
                        <div>
                            <p class="text-xs font-bold text-gray-600">KANDIDAT</p>
                            <p class="text-lg font-black text-black">3</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Candidates Section -->
        <div class="max-w-6xl mx-auto">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

                <!-- Candidate 1 -->
                <div
                    class="candidate-card bg-white border-4 border-black shadow-[8px_8px_0px_0px_#000] overflow-hidden">
                    <!-- Candidate Number -->
                    <div class="bg-blue-500 text-white text-center py-2 border-b-3 border-black">
                        <span class="text-3xl font-black">01</span>
                    </div>

                    <!-- Photo -->
                    <div class="p-4 border-b-3 border-black">
                        <div
                            class="w-full h-48 bg-gradient-to-br from-blue-200 to-blue-400 border-3 border-black flex items-center justify-center">
                            <iconify-icon icon="mdi:account" width="80" height="80" class="text-black"></iconify-icon>
                        </div>
                    </div>

                    <!-- Candidate Info -->
                    <div class="p-4 border-b-3 border-black">
                        <h3 class="text-xl font-black text-black mb-1">AHMAD RIZKI</h3>
                        <p
                            class="text-sm font-bold text-gray-600 bg-gray-100 border-2 border-black px-2 py-1 inline-block">
                            KELAS XI IPA 2
                        </p>
                    </div>

                    <!-- Vision & Mission -->
                    <div class="p-4 border-b-3 border-black">
                        <h4
                            class="text-sm font-black text-black mb-2 bg-yellow-200 border-2 border-black px-2 py-1 inline-block">
                            VISI & MISI
                        </h4>
                        <p class="text-sm text-gray-700 leading-relaxed">
                            "Membangun OSIS yang solid, kreatif, dan berprestasi dengan program-program inovatif untuk
                            kemajuan sekolah dan siswa."
                        </p>
                    </div>

                    <!-- Vote Button -->
                    <div class="p-4">
                        <button onclick="vote(1, 'Ahmad Rizki')"
                            class="w-full bg-blue-500 text-white border-3 border-black py-3 text-lg font-black hover:-translate-x-1 hover:-translate-y-1 hover:shadow-[4px_4px_0px_0px_#000] active:translate-x-2 active:translate-y-2 active:shadow-[2px_2px_0px_0px_#000] transition-all">
                            PILIH KANDIDAT 01
                        </button>
                    </div>
                </div>

                <!-- Candidate 2 -->
                <div
                    class="candidate-card bg-white border-4 border-black shadow-[8px_8px_0px_0px_#000] overflow-hidden">
                    <!-- Candidate Number -->
                    <div class="bg-green-500 text-white text-center py-2 border-b-3 border-black">
                        <span class="text-3xl font-black">02</span>
                    </div>

                    <!-- Photo -->
                    <div class="p-4 border-b-3 border-black">
                        <div
                            class="w-full h-48 bg-gradient-to-br from-green-200 to-green-400 border-3 border-black flex items-center justify-center">
                            <iconify-icon icon="mdi:account" width="80" height="80" class="text-black"></iconify-icon>
                        </div>
                    </div>

                    <!-- Candidate Info -->
                    <div class="p-4 border-b-3 border-black">
                        <h3 class="text-xl font-black text-black mb-1">SARI INDAH</h3>
                        <p
                            class="text-sm font-bold text-gray-600 bg-gray-100 border-2 border-black px-2 py-1 inline-block">
                            KELAS XI IPS 1
                        </p>
                    </div>

                    <!-- Vision & Mission -->
                    <div class="p-4 border-b-3 border-black">
                        <h4
                            class="text-sm font-black text-black mb-2 bg-yellow-200 border-2 border-black px-2 py-1 inline-block">
                            VISI & MISI
                        </h4>
                        <p class="text-sm text-gray-700 leading-relaxed">
                            "Menciptakan lingkungan sekolah yang harmonis dan berprestasi melalui kegiatan yang
                            bermanfaat dan networking yang kuat."
                        </p>
                    </div>

                    <!-- Vote Button -->
                    <div class="p-4">
                        <button onclick="vote(2, 'Sari Indah')"
                            class="w-full bg-green-500 text-white border-3 border-black py-3 text-lg font-black hover:-translate-x-1 hover:-translate-y-1 hover:shadow-[4px_4px_0px_0px_#000] active:translate-x-2 active:translate-y-2 active:shadow-[2px_2px_0px_0px_#000] transition-all">
                            PILIH KANDIDAT 02
                        </button>
                    </div>
                </div>

                <!-- Candidate 3 -->
                <div
                    class="candidate-card bg-white border-4 border-black shadow-[8px_8px_0px_0px_#000] overflow-hidden">
                    <!-- Candidate Number -->
                    <div class="bg-purple-500 text-white text-center py-2 border-b-3 border-black">
                        <span class="text-3xl font-black">03</span>
                    </div>

                    <!-- Photo -->
                    <div class="p-4 border-b-3 border-black">
                        <div
                            class="w-full h-48 bg-gradient-to-br from-purple-200 to-purple-400 border-3 border-black flex items-center justify-center">
                            <iconify-icon icon="mdi:account" width="80" height="80" class="text-black"></iconify-icon>
                        </div>
                    </div>

                    <!-- Candidate Info -->
                    <div class="p-4 border-b-3 border-black">
                        <h3 class="text-xl font-black text-black mb-1">BAYU PRATAMA</h3>
                        <p
                            class="text-sm font-bold text-gray-600 bg-gray-100 border-2 border-black px-2 py-1 inline-block">
                            KELAS XI MIPA 3
                        </p>
                    </div>

                    <!-- Vision & Mission -->
                    <div class="p-4 border-b-3 border-black">
                        <h4
                            class="text-sm font-black text-black mb-2 bg-yellow-200 border-2 border-black px-2 py-1 inline-block">
                            VISI & MISI
                        </h4>
                        <p class="text-sm text-gray-700 leading-relaxed">
                            "Fokus pada pengembangan talenta siswa melalui workshop, kompetisi, dan kegiatan
                            ekstrakurikuler yang berkualitas."
                        </p>
                    </div>

                    <!-- Vote Button -->
                    <div class="p-4">
                        <button onclick="vote(3, 'Bayu Pratama')"
                            class="w-full bg-purple-500 text-white border-3 border-black py-3 text-lg font-black hover:-translate-x-1 hover:-translate-y-1 hover:shadow-[4px_4px_0px_0px_#000] active:translate-x-2 active:translate-y-2 active:shadow-[2px_2px_0px_0px_#000] transition-all">
                            PILIH KANDIDAT 03
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Voting Rules -->
        <div class="max-w-4xl mx-auto mt-8">
            <div class="bg-white border-4 border-black shadow-[8px_8px_0px_0px_#000] p-6">
                <h3 class="text-xl font-black text-black mb-4 bg-red-200 border-2 border-black px-3 py-2 inline-block">
                    ‚ö†Ô∏è ATURAN VOTING
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="flex items-start gap-3">
                        <div
                            class="w-6 h-6 bg-black text-white flex items-center justify-center flex-shrink-0 mt-0.5 font-black text-xs">
                            1
                        </div>
                        <p class="text-sm font-medium text-gray-700">Setiap siswa hanya dapat memberikan SATU suara</p>
                    </div>
                    <div class="flex items-start gap-3">
                        <div
                            class="w-6 h-6 bg-black text-white flex items-center justify-center flex-shrink-0 mt-0.5 font-black text-xs">
                            2
                        </div>
                        <p class="text-sm font-medium text-gray-700">Voting akan ditutup sesuai waktu yang ditentukan
                        </p>
                    </div>
                    <div class="flex items-start gap-3">
                        <div
                            class="w-6 h-6 bg-black text-white flex items-center justify-center flex-shrink-0 mt-0.5 font-black text-xs">
                            3
                        </div>
                        <p class="text-sm font-medium text-gray-700">Pilihan tidak dapat diubah setelah submit</p>
                    </div>
                    <div class="flex items-start gap-3">
                        <div
                            class="w-6 h-6 bg-black text-white flex items-center justify-center flex-shrink-0 mt-0.5 font-black text-xs">
                            4
                        </div>
                        <p class="text-sm font-medium text-gray-700">Hasil akan diumumkan secara transparan</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-black text-white border-t-4 border-white mt-12 p-4">
        <div class="container mx-auto text-center">
            <p class="text-sm font-medium">¬© 2025 EVotingKita - Sistem Voting Digital Sekolah</p>
        </div>
    </footer>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white border-4 border-black shadow-[12px_12px_0px_0px_#000] p-6 max-w-md w-full">
                <h3 class="text-2xl font-black text-black mb-4">KONFIRMASI PILIHAN</h3>
                <p class="text-base font-medium text-gray-700 mb-4">
                    Anda akan memilih kandidat:
                </p>
                <div class="bg-yellow-100 border-2 border-black p-3 mb-6">
                    <p class="text-lg font-black text-black" id="selectedCandidate">-</p>
                </div>
                <p class="text-sm font-medium text-red-600 mb-6">
                    ‚ö†Ô∏è Pilihan tidak dapat diubah setelah dikonfirmasi!
                </p>
                <div class="flex gap-3">
                    <button onclick="closeModal()"
                        class="flex-1 bg-gray-300 text-black border-3 border-black py-3 font-black hover:-translate-x-1 hover:-translate-y-1 hover:shadow-[4px_4px_0px_0px_#000] transition-all">
                        BATAL
                    </button>
                    <button onclick="confirmVote()"
                        class="flex-1 bg-green-500 text-white border-3 border-black py-3 font-black hover:-translate-x-1 hover:-translate-y-1 hover:shadow-[4px_4px_0px_0px_#000] transition-all">
                        KONFIRMASI
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white border-4 border-black shadow-[16px_16px_0px_0px_#000] p-8 max-w-lg w-full">
                <!-- Success Icon -->
                <div class="text-center mb-6">
                    <div
                        class="w-16 h-16 bg-green-500 border-3 border-black rounded-full flex items-center justify-center mx-auto mb-4">
                        <iconify-icon icon="mdi:check-bold" width="32" height="32" class="text-white"></iconify-icon>
                    </div>
                    <h3 class="text-3xl font-black text-black mb-2">VOTING BERHASIL!</h3>
                    <div class="bg-green-100 border-2 border-black p-3 inline-block">
                        <iconify-icon icon="mdi:party-popper" width="20" height="20"
                            class="text-black mr-2"></iconify-icon>
                        <span class="font-bold text-green-800">Terima kasih atas partisipasi Anda!</span>
                    </div>
                </div>

                <!-- Vote Details -->
                <div class="bg-yellow-100 border-3 border-black p-4 mb-6">
                    <h4 class="text-sm font-black mb-2 bg-black text-yellow-300 px-2 py-1 inline-block">
                        PILIHAN ANDA
                    </h4>
                    <p class="text-xl font-black text-black" id="votedCandidate">-</p>
                    <p class="text-sm text-gray-600 mt-1">
                        <iconify-icon icon="mdi:clock-outline" width="14" height="14" class="mr-1"></iconify-icon>
                        <span id="voteTime"></span>
                    </p>
                </div>

                <!-- Success Message -->
                <div class="text-center mb-6">
                    <div class="bg-blue-100 border-2 border-black p-4">
                        <h4 class="font-black text-black mb-2">üó≥Ô∏è VOTE ANDA TELAH TERCATAT!</h4>
                        <p class="text-sm text-gray-700 mb-2">
                            Suara Anda sangat berarti untuk masa depan OSIS yang lebih baik.
                        </p>
                        <p class="text-xs font-medium text-gray-600 bg-gray-100 border border-black p-2">
                            <iconify-icon icon="mdi:shield-check" width="12" height="12" class="mr-1"></iconify-icon>
                            Data voting disimpan dengan aman dan terenkripsi
                        </p>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex flex-col sm:flex-row gap-3">
                    <button onclick="closeSuccessModal()"
                        class="flex-1 bg-blue-500 text-white border-3 border-black py-3 font-black hover:-translate-x-1 hover:-translate-y-1 hover:shadow-[4px_4px_0px_0px_#000] transition-all">
                        TUTUP
                    </button>
                    <button onclick="showLogoutModal()"
                        class="flex-1 bg-red-500 text-white border-3 border-black py-3 font-black hover:-translate-x-1 hover:-translate-y-1 hover:shadow-[4px_4px_0px_0px_#000] transition-all">
                        LOGOUT
                    </button>
                </div>

                <!-- Additional Info -->
                <div class="mt-6 text-center">
                    <p class="text-xs text-gray-600 bg-pink-100 border-2 border-black p-2">
                        <iconify-icon icon="mdi:information-outline" width="12" height="12" class="mr-1"></iconify-icon>
                        Hasil final akan diumumkan setelah periode voting berakhir
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Logout Confirmation Modal -->
    <div id="logoutModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white border-4 border-black shadow-[12px_12px_0px_0px_#000] p-6 max-w-md w-full">
                <div class="text-center mb-6">
                    <div
                        class="w-16 h-16 bg-red-500 border-3 border-black rounded-full flex items-center justify-center mx-auto mb-4">
                        <iconify-icon icon="mdi:logout" width="32" height="32" class="text-white"></iconify-icon>
                    </div>
                    <h3 class="text-2xl font-black text-black mb-2">KONFIRMASI LOGOUT</h3>
                </div>

                <div class="text-center mb-6">
                    <p class="text-base font-medium text-gray-700 mb-2">
                        Apakah Anda yakin ingin keluar?
                    </p>
                </div>

                <div class="flex gap-3">
                    <button onclick="closeLogoutModal()"
                        class="flex-1 bg-gray-300 text-black border-3 border-black py-3 font-black hover:-translate-x-1 hover:-translate-y-1 hover:shadow-[4px_4px_0px_0px_#000] transition-all">
                        BATAL
                    </button>
                    <button onclick="confirmLogout()"
                        class="flex-1 bg-red-500 text-white border-3 border-black py-3 font-black hover:-translate-x-1 hover:-translate-y-1 hover:shadow-[4px_4px_0px_0px_#000] transition-all">
                        YA, LOGOUT
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Error Modal -->
    <div id="errorModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white border-4 border-black shadow-[12px_12px_0px_0px_#000] p-6 max-w-md w-full">
                <!-- Error Icon -->
                <div class="text-center mb-6">
                    <div
                        class="w-16 h-16 bg-red-500 border-3 border-black rounded-full flex items-center justify-center mx-auto mb-4">
                        <iconify-icon icon="mdi:alert-circle" width="32" height="32" class="text-white"></iconify-icon>
                    </div>
                    <h3 class="text-2xl font-black text-black mb-2">VOTING GAGAL!</h3>
                    <div class="bg-red-100 border-2 border-black p-3 inline-block">
                        <iconify-icon icon="mdi:close-circle" width="20" height="20"
                            class="text-black mr-2"></iconify-icon>
                        <span class="font-bold text-red-800" id="errorMessage">Terjadi kesalahan sistem</span>
                    </div>
                </div>

                <!-- Error Details -->
                <div class="bg-yellow-100 border-3 border-black p-4 mb-6">
                    <h4 class="text-sm font-black text-black mb-2 bg-black px-2 py-1 inline-block">
                        DETAIL ERROR
                    </h4>
                    <p class="text-sm text-gray-700" id="errorDetails">
                        Silakan coba lagi atau hubungi administrator
                    </p>
                </div>

                <!-- Action Buttons -->
                <div class="flex flex-col sm:flex-row gap-3">
                    <button onclick="closeErrorModal()"
                        class="flex-1 bg-blue-500 text-white border-3 border-black py-3 font-black hover:-translate-x-1 hover:-translate-y-1 hover:shadow-[4px_4px_0px_0px_#000] transition-all">
                        COBA LAGI
                    </button>
                    <button onclick="showLogoutModal()"
                        class="flex-1 bg-red-500 text-white border-3 border-black py-3 font-black hover:-translate-x-1 hover:-translate-y-1 hover:shadow-[4px_4px_0px_0px_#000] transition-all">
                        LOGOUT
                    </button>
                </div>

                <!-- Help Info -->
                <div class="mt-4 text-center">
                    <p class="text-xs text-gray-600 bg-pink-100 border-2 border-black p-2">
                        <iconify-icon icon="mdi:help-circle" width="12" height="12" class="mr-1"></iconify-icon>
                        Butuh bantuan? Hubungi panitia voting
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Modal -->
    <div id="loadingModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white border-4 border-black shadow-[12px_12px_0px_0px_#000] p-6 max-w-md w-full">
                <div class="text-center">
                    <div
                        class="w-16 h-16 bg-blue-500 border-3 border-black rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse">
                        <iconify-icon icon="mdi:loading" width="32" height="32"
                            class="text-white animate-spin"></iconify-icon>
                    </div>
                    <h3 class="text-2xl font-black text-black mb-2">MEMPROSES VOTE...</h3>
                    <p class="text-base font-medium text-gray-700 bg-yellow-100 border-2 border-black p-3">
                        Sedang menyimpan pilihan Anda
                    </p>
                    <div class="mt-4">
                        <div class="bg-blue-100 border-2 border-black p-2">
                            <p class="text-xs text-gray-600">
                                <iconify-icon icon="mdi:shield-check" width="12" height="12"
                                    class="mr-1"></iconify-icon>
                                Proses ini dapat memakan waktu beberapa detik
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let selectedCandidateNumber = null;
        let selectedCandidateName = null;
        let hasVoted = false;
        let sessionStartTime = new Date();
        let isProcessing = false;

        // Set waktu berakhir voting (contoh: 2 jam 45 menit 30 detik dari sekarang)
        const votingEndTime = new Date();
        votingEndTime.setHours(votingEndTime.getHours() + 2);
        votingEndTime.setMinutes(votingEndTime.getMinutes() + 45);
        votingEndTime.setSeconds(votingEndTime.getSeconds() + 30);

        console.log('‚è∞ Voting akan berakhir pada:', votingEndTime.toLocaleString('id-ID'));

        // Countdown timer yang berjalan mundur
        function updateCountdown() {
            const countdownElement = document.getElementById('countdown');
            if (countdownElement) {
                const now = new Date();
                const timeDiff = votingEndTime - now;

                if (timeDiff > 0) {
                    // Hitung jam, menit, detik yang tersisa
                    const hours = Math.floor(timeDiff / (1000 * 60 * 60));
                    const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((timeDiff % (1000 * 60)) / 1000);

                    // Format dengan leading zero
                    const formattedTime = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    countdownElement.textContent = formattedTime;

                    // Ubah warna berdasarkan waktu tersisa
                    const totalMinutesLeft = Math.floor(timeDiff / (1000 * 60));

                    if (totalMinutesLeft <= 5) {
                        // Merah jika kurang dari 5 menit
                        countdownElement.className = 'text-2xl font-black text-red-600';
                        countdownElement.parentElement.className = 'bg-red-100 border-2 border-black p-3';
                    } else if (totalMinutesLeft <= 30) {
                        // Orange jika kurang dari 30 menit
                        countdownElement.className = 'text-2xl font-black text-orange-600';
                        countdownElement.parentElement.className = 'bg-orange-100 border-2 border-black p-3';
                    } else {
                        // Merah normal untuk waktu yang masih banyak
                        countdownElement.className = 'text-2xl font-black text-red-600';
                        countdownElement.parentElement.className = 'bg-red-100 border-2 border-black p-3';
                    }

                    console.log(`‚è∞ Waktu tersisa: ${formattedTime} (${totalMinutesLeft} menit)`);
                } else {
                    // Waktu habis
                    countdownElement.textContent = "00:00:00";
                    countdownElement.className = 'text-2xl font-black text-red-600';

                    // Disable semua tombol voting
                    disableAllVoteButtons();

                    // Tampilkan pesan waktu habis
                    showTimeUpModal();

                    console.log('‚è∞ Waktu voting telah habis!');
                }
            }
        }

        // Fungsi untuk menampilkan modal waktu habis
        function showTimeUpModal() {
            // Buat modal waktu habis jika belum ada
            let timeUpModal = document.getElementById('timeUpModal');
            if (!timeUpModal) {
                timeUpModal = document.createElement('div');
                timeUpModal.id = 'timeUpModal';
                timeUpModal.className = 'fixed inset-0 bg-black bg-opacity-50 z-50';
                timeUpModal.innerHTML = `
                    <div class="flex items-center justify-center min-h-screen p-4">
                        <div class="bg-white border-4 border-black shadow-[16px_16px_0px_0px_#000] p-8 max-w-lg w-full">
                            <!-- Time Up Icon -->
                            <div class="text-center mb-6">
                                <div class="w-16 h-16 bg-red-500 border-3 border-black rounded-full flex items-center justify-center mx-auto mb-4">
                                    <iconify-icon icon="mdi:clock-alert" width="32" height="32" class="text-white"></iconify-icon>
                                </div>
                                <h3 class="text-3xl font-black text-black mb-2">WAKTU HABIS!</h3>
                                <div class="bg-red-100 border-2 border-black p-3 inline-block">
                                    <iconify-icon icon="mdi:timer-off" width="20" height="20" class="text-black mr-2"></iconify-icon>
                                    <span class="font-bold text-red-800">Periode voting telah berakhir</span>
                                </div>
                            </div>

                            <!-- Time Up Message -->
                            <div class="text-center mb-6">
                                <div class="bg-yellow-100 border-2 border-black p-4">
                                    <h4 class="font-black text-black mb-2">‚è∞ VOTING DITUTUP!</h4>
                                    <p class="text-sm text-gray-700 mb-2">
                                        Periode voting untuk Pemilihan Ketua OSIS 2025 telah berakhir.
                                    </p>
                                    <p class="text-xs font-medium text-gray-600 bg-gray-100 border border-black p-2">
                                        <iconify-icon icon="mdi:information" width="12" height="12" class="mr-1"></iconify-icon>
                                        Hasil akan diumumkan dalam waktu dekat
                                    </p>
                                </div>
                            </div>

                            <!-- Action Button -->
                            <div class="flex justify-center">
                                <button onclick="window.location.href='sign_in.html'"
                                    class="bg-blue-500 text-white border-3 border-black py-3 px-6 font-black hover:-translate-x-1 hover:-translate-y-1 hover:shadow-[4px_4px_0px_0px_#000] transition-all">
                                    KEMBALI KE LOGIN
                                </button>
                            </div>

                            <!-- Additional Info -->
                            <div class="mt-6 text-center">
                                <p class="text-xs text-gray-600 bg-pink-100 border-2 border-black p-2">
                                    <iconify-icon icon="mdi:trophy" width="12" height="12" class="mr-1"></iconify-icon>
                                    Terima kasih atas partisipasi Anda dalam pemilihan ini!
                                </p>
                            </div>
                        </div>
                    </div>
                `;
                document.body.appendChild(timeUpModal);
            }

            // Tampilkan modal
            timeUpModal.classList.remove('hidden');
        }

        // Update countdown setiap detik
        const countdownInterval = setInterval(updateCountdown, 1000);
        updateCountdown(); // Jalankan langsung saat load

        // Vote function dengan debug yang lebih detail
        function vote(candidateNumber, candidateName) {
            console.log('üó≥Ô∏è Vote function called:', candidateNumber, candidateName);
            console.log('Current state - hasVoted:', hasVoted, 'isProcessing:', isProcessing);

            // Cek apakah masih dalam periode voting
            const now = new Date();
            if (now >= votingEndTime) {
                console.log('‚è∞ Voting time is over');
                showTimeUpModal();
                return;
            }

            if (hasVoted) {
                console.log('‚ùå Already voted, showing error modal');
                showErrorModal('Anda sudah melakukan voting!', 'Setiap siswa hanya dapat memberikan satu suara.');
                return;
            }

            if (isProcessing) {
                console.log('‚è≥ Already processing, showing error modal');
                showErrorModal('Sedang memproses vote lain!', 'Tunggu hingga proses selesai.');
                return;
            }

            selectedCandidateNumber = candidateNumber;
            selectedCandidateName = candidateName;

            const selectedElement = document.getElementById('selectedCandidate');
            if (selectedElement) {
                selectedElement.textContent = `${candidateNumber.toString().padStart(2, '0')} - ${candidateName}`;
                console.log('‚úÖ Updated selectedCandidate element');
            } else {
                console.log('‚ùå selectedCandidate element not found');
            }

            const confirmModal = document.getElementById('confirmModal');
            if (confirmModal) {
                confirmModal.classList.remove('hidden');
                console.log('‚úÖ Confirmation modal shown');
            } else {
                console.log('‚ùå confirmModal element not found');
            }
        }

        // Close confirmation modal
        function closeModal() {
            console.log('üö™ Closing confirmation modal');
            document.getElementById('confirmModal').classList.add('hidden');
            selectedCandidateNumber = null;
            selectedCandidateName = null;
        }

        // Show loading modal
        function showLoadingModal() {
            console.log('‚è≥ Showing loading modal');
            const loadingModal = document.getElementById('loadingModal');
            if (loadingModal) {
                loadingModal.classList.remove('hidden');
            }
        }

        // Hide loading modal
        function hideLoadingModal() {
            console.log('‚è≥ Hiding loading modal');
            const loadingModal = document.getElementById('loadingModal');
            if (loadingModal) {
                loadingModal.classList.add('hidden');
            }
        }

        // Show error modal
        function showErrorModal(message, details) {
            console.log('‚ùå Showing error modal:', message);
            const errorMessageElement = document.getElementById('errorMessage');
            const errorDetailsElement = document.getElementById('errorDetails');
            const errorModal = document.getElementById('errorModal');

            if (errorMessageElement) errorMessageElement.textContent = message;
            if (errorDetailsElement) errorDetailsElement.textContent = details;
            if (errorModal) errorModal.classList.remove('hidden');
        }

        // Close error modal
        function closeErrorModal() {
            console.log('‚ùå Closing error modal');
            const errorModal = document.getElementById('errorModal');
            if (errorModal) {
                errorModal.classList.add('hidden');
            }
        }

        // Confirm vote dengan debug yang detail
        function confirmVote() {
            console.log('‚úÖ Confirm vote called:', selectedCandidateNumber, selectedCandidateName);
            console.log('Current state - hasVoted:', hasVoted, 'isProcessing:', isProcessing);

            // Double check waktu voting
            const now = new Date();
            if (now >= votingEndTime) {
                console.log('‚è∞ Voting time expired during confirmation');
                closeModal();
                showTimeUpModal();
                return;
            }

            if (!selectedCandidateNumber || !selectedCandidateName) {
                console.log('‚ùå No candidate selected');
                return;
            }

            if (isProcessing) {
                console.log('‚è≥ Already processing, ignoring');
                return;
            }

            // Close confirmation modal
            closeModal();

            // Set processing state
            isProcessing = true;
            console.log('‚è≥ Set processing to true');

            // Show loading modal
            showLoadingModal();

            // Simulate voting process dengan GUARANTEED SUCCESS
            setTimeout(() => {
                console.log('‚è≥ Processing timeout completed');
                hideLoadingModal();
                isProcessing = false;

                // GUARANTEED SUCCESS untuk testing
                const isSuccess = true;
                console.log('üéØ Vote result:', isSuccess ? 'SUCCESS' : 'FAILED');

                if (isSuccess) {
                    console.log('üéâ Vote successful, updating state');

                    // Update state
                    hasVoted = true;
                    console.log('‚úÖ hasVoted set to:', hasVoted);

                    // Disable buttons
                    disableAllVoteButtons();
                    console.log('üö´ All buttons disabled');

                    // Show success modal
                    console.log('üéâ About to show success modal');
                    showSuccessModal();
                } else {
                    // Error handling (tidak akan terjadi karena isSuccess = true)
                    const errorMessages = [
                        {
                            message: 'Koneksi ke server terputus!',
                            details: 'Silakan periksa koneksi internet Anda dan coba lagi.'
                        }
                    ];

                    const randomError = errorMessages[0];
                    showErrorModal(randomError.message, randomError.details);

                    selectedCandidateNumber = null;
                    selectedCandidateName = null;
                }
            }, 2000);
        }

        // Disable all vote buttons
        function disableAllVoteButtons() {
            console.log('üö´ Disabling all vote buttons');
            const buttons = document.querySelectorAll('.candidate-card button');
            console.log('Found buttons:', buttons.length);

            buttons.forEach((button, index) => {
                button.disabled = true;
                button.classList.add('opacity-50', 'cursor-not-allowed');
                button.classList.remove('hover:-translate-x-1', 'hover:-translate-y-1', 'hover:shadow-[4px_4px_0px_0px_#000]');

                // Ubah text berdasarkan kondisi
                const now = new Date();
                if (now >= votingEndTime) {
                    button.textContent = 'VOTING DITUTUP';
                } else {
                    button.textContent = 'SUDAH MEMILIH';
                }

                console.log(`Button ${index + 1} disabled`);
            });
        }

        // Show success modal dengan debug detail
        function showSuccessModal() {
            console.log('üéâ showSuccessModal called');
            console.log('State check - hasVoted:', hasVoted);
            console.log('Selected:', selectedCandidateNumber, selectedCandidateName);

            if (!hasVoted) {
                console.log('‚ùå Not showing success modal because hasVoted is false');
                return;
            }

            // Set vote details
            const votedCandidateElement = document.getElementById('votedCandidate');
            if (votedCandidateElement && selectedCandidateNumber && selectedCandidateName) {
                const candidateText = `${selectedCandidateNumber.toString().padStart(2, '0')} - ${selectedCandidateName}`;
                votedCandidateElement.textContent = candidateText;
                console.log('‚úÖ Updated votedCandidate:', candidateText);
            } else {
                console.log('‚ùå Failed to update votedCandidate element');
            }

            // Set current time dengan format Indonesia
            const now = new Date();
            const timeString = now.toLocaleString('id-ID', {
                weekday: 'long',
                day: '2-digit',
                month: 'long',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                timeZone: 'Asia/Jakarta'
            });

            const voteTimeElement = document.getElementById('voteTime');
            if (voteTimeElement) {
                voteTimeElement.textContent = `Dicatat pada: ${timeString}`;
                console.log('‚úÖ Updated voteTime:', timeString);
            } else {
                console.log('‚ùå voteTime element not found');
            }

            // Show modal
            const successModal = document.getElementById('successModal');
            if (successModal) {
                successModal.classList.remove('hidden');
                console.log('‚úÖ Success modal should be visible now');
                console.log('Modal classes:', successModal.className);

                // Force visibility check
                setTimeout(() => {
                    const computedStyle = window.getComputedStyle(successModal);
                    console.log('Modal computed display:', computedStyle.display);
                    console.log('Modal computed visibility:', computedStyle.visibility);
                }, 100);
            } else {
                console.log('‚ùå successModal element not found');
            }

            // Add animation effect
            const modalContent = successModal?.querySelector('div > div');
            if (modalContent) {
                modalContent.style.transform = 'scale(0.8)';
                modalContent.style.opacity = '0';

                setTimeout(() => {
                    modalContent.style.transform = 'scale(1)';
                    modalContent.style.opacity = '1';
                    modalContent.style.transition = 'all 0.3s ease-out';
                    console.log('‚úÖ Modal animation applied');
                }, 100);
            } else {
                console.log('‚ùå Modal content for animation not found');
            }
        }

        // Close success modal
        function closeSuccessModal() {
            console.log('üéâ Closing success modal');
            const successModal = document.getElementById('successModal');
            if (successModal) {
                successModal.classList.add('hidden');
            }
        }

        // Show logout modal
        function showLogoutModal() {
            console.log('üö™ Showing logout modal');
            const logoutModal = document.getElementById('logoutModal');
            const successModal = document.getElementById('successModal');
            const errorModal = document.getElementById('errorModal');

            if (logoutModal) logoutModal.classList.remove('hidden');
            if (successModal) successModal.classList.add('hidden');
            if (errorModal) errorModal.classList.add('hidden');
        }

        // Close logout modal
        function closeLogoutModal() {
            console.log('üö™ Closing logout modal');
            const logoutModal = document.getElementById('logoutModal');
            if (logoutModal) {
                logoutModal.classList.add('hidden');
            }
        }

        // Confirm logout
        function confirmLogout() {
            console.log('üö™ Confirming logout, redirecting to sign_in.html');
            window.location.href = 'sign_in.html';
        }

        // Header logout button click handler
        document.addEventListener('DOMContentLoaded', function () {
            console.log('üìÑ DOM Content Loaded');
            console.log('‚è∞ Countdown timer started, voting ends at:', votingEndTime.toLocaleString('id-ID'));

            const headerLogoutBtn = document.querySelector('header button');
            if (headerLogoutBtn) {
                headerLogoutBtn.addEventListener('click', function (e) {
                    e.preventDefault();
                    showLogoutModal();
                });
                console.log('‚úÖ Header logout button event attached');
            } else {
                console.log('‚ùå Header logout button not found');
            }

            // Debug: Check if all modal elements exist
            const modals = ['confirmModal', 'successModal', 'logoutModal', 'errorModal', 'loadingModal'];
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                console.log(`Modal ${modalId}:`, modal ? '‚úÖ Found' : '‚ùå Not found');
            });
        });

        // Clean up interval when page unloads
        window.addEventListener('beforeunload', function () {
            if (countdownInterval) {
                clearInterval(countdownInterval);
            }
        });

        // Close modals when clicking outside
        document.getElementById('confirmModal')?.addEventListener('click', function (e) {
            if (e.target === this) {
                closeModal();
            }
        });

        document.getElementById('successModal')?.addEventListener('click', function (e) {
            if (e.target === this) {
                closeSuccessModal();
            }
        });

        document.getElementById('logoutModal')?.addEventListener('click', function (e) {
            if (e.target === this) {
                closeLogoutModal();
            }
        });

        document.getElementById('errorModal')?.addEventListener('click', function (e) {
            if (e.target === this) {
                closeErrorModal();
            }
        });

        // Prevent closing loading modal
        document.getElementById('loadingModal')?.addEventListener('click', function (e) {
            e.stopPropagation();
        });

        // Prevent accidental modal closing by clicking on content
        document.querySelectorAll('.bg-white').forEach(modal => {
            modal.addEventListener('click', function (e) {
                e.stopPropagation();
            });
        });
    </script>

</body>

</html>